{% extends "layout.html" %}
{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="content-section"> {# Added consistent padding #}
    <div class="d-flex justify-content-between align-items-center mb-4"> {# Increased margin #}
        <h1>Dashboard</h1>
        <a href="{{ url_for('create_form') }}" class="btn btn-primary shadow-sm">Create New Form</a>
    </div>
    {# Removed <hr>, replaced by spacing #}

    <h2 class="h4 mb-3">Your Forms</h2> {# Use slightly smaller heading #}

    {% if user_forms %}
      <div class="list-group">
        {% for form in user_forms %}
          {# Use list-group-item for each form #}
          <div class="list-group-item list-group-item-action_ flex-column align-items-start p-3 mb-3 border rounded shadow-sm"> {# Added padding, margin, border, shadow #}
            <div class="d-flex w-100 justify-content-between mb-2"> {# Added margin-bottom #}
              <h5 class="mb-1"><a href="{{ url_for('edit_form', form_id=form.id) }}" class="text-decoration-none stretched-link">{{ form.title }}</a></h5> {# Stretched-link makes whole item clickable #}
              <small class="text-muted flex-shrink-0 ms-3">{{ form.created_at.strftime('%Y-%m-%d') }}</small> {# Short date, shrink/margin #}
            </div>
            <p class="mb-2 text-muted small">{{ form.description or 'No description provided.' }}</p> {# Smaller text for description #}
            {# Removed unique key display for cleaner look #}
            {# <small class="text-muted">Unique Key: <code class="user-select-all">{{ form.unique_key }}</code></small> #}
            <div class="mt-2 action-buttons"> {# Add class to potentially hide on item hover later #}
                {# Consistent small outline buttons #}
                <a href="{{ url_for('edit_form', form_id=form.id) }}" class="btn btn-sm btn-outline-secondary me-1 z-1 position-relative">Manage Fields</a> {# z-1 needed with stretched-link #}
                <a href="{{ url_for('view_submissions', form_id=form.id) }}" class="btn btn-sm btn-outline-info me-1 z-1 position-relative">View Submissions</a>
                <button type="button" class="btn btn-sm btn-outline-success me-1 z-1 position-relative" data-bs-toggle="modal" data-bs-target="#embedModal_{{ form.id }}">
                  Embed / Share
                </button>
                {# Delete Button Form #}
                <form action="{{ url_for('delete_form', form_id=form.id) }}" method="POST" style="display: inline;" class="z-1 position-relative">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="btn btn-sm btn-outline-danger"
                            onclick="return confirm('Are you sure you want to delete the form \'{{ form.title }}\' and all its submissions? This cannot be undone.');">
                        Delete
                    </button>
                </form>
            </div>
          </div>{# End list-group-item #}

          {# --- Embed Modal Definition (Keep as is from previous step) --- #}
          <div class="modal fade" id="embedModal_{{ form.id }}" ... >
              {# ... Modal content ... #}
          </div>
          {# --- End Embed Modal Definition --- #}

        {% endfor %}{# End of the form loop #}
      </div>{# End list-group #}

    {% else %}
      <div class="alert alert-info" role="alert">
          You haven't created any forms yet. <a href="{{ url_for('create_form') }}" class="alert-link">Create one now!</a>
      </div>
    {% endif %}

</div> {# End content-section #}

{# --- JavaScript for Copy Button (Keep as is from previous step) --- #}
<script>
function copyEmbedCode(textAreaId, buttonElement) { /* ... */ }
function copyDirectLink(inputId, buttonElement) { /* ... */ }
</script>

{% endblock content %}
